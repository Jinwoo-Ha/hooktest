#!/bin/sh

echo "ğŸ” Push ì „ íŒŒì¼ ê²€ì‚¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤..."

# ì‚­ì œëœ íŒŒì¼ í™•ì¸
deleted_files=$(git diff origin/main...HEAD --diff-filter=D --name-only)

# ì‚­ì œëœ íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
if [ ! -z "$deleted_files" ]; then
    echo ""
    echo "âš ï¸ ê²½ê³ : ë‹¤ìŒ íŒŒì¼ë“¤ì´ ì‚­ì œë  ì˜ˆì •ì…ë‹ˆë‹¤:"
    echo "$deleted_files"
    echo ""
    echo "ì‚­ì œë¥¼ ì§„í–‰í•˜ë ¤ë©´ 'yes'ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
    echo "ì…ë ¥ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘..."
    
    # ì‚¬ìš©ì ì…ë ¥ì„ ë°›ì„ ë•Œê¹Œì§€ ëŒ€ê¸°
    while true; do
        read -r answer
        if [ "$answer" = "yes" ]; then
            echo ""
            echo "âœ… ì‚­ì œë¥¼ ì§„í–‰í•©ë‹ˆë‹¤."
            break
        elif [ ! -z "$answer" ]; then
            echo ""
            echo "âŒ Pushê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."
            exit 1
        fi
    done
fi

echo "âœ… Pushë¥¼ ì§„í–‰í•©ë‹ˆë‹¤."
exit 0