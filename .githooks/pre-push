#!/bin/sh

echo "🔍 Push 전 파일 검사를 시작합니다..."

# 원격 브랜치와 비교하여 삭제된 파일 확인
deleted_files=$(git diff origin/main...HEAD --diff-filter=D --name-only)

if [ ! -z "$deleted_files" ]; then
    echo ""
    echo "⚠️ 경고: 다음 파일들이 삭제될 예정입니다:"
    echo "$deleted_files"
    echo ""
    echo "정말로 이 파일들을 삭제하시겠습니까?"
    echo "아래에 'yes'를 입력하고 Enter를 누르세요."
    echo "(취소하려면 다른 키를 입력하세요)"
    echo ""
    printf "입력: "
    read response
    
    if [ "$response" != "yes" ]; then
        echo ""
        echo "❌ Push가 취소되었습니다."
        exit 1
    fi
fi

echo "✅ 파일 검사가 완료되었습니다."
exit 0